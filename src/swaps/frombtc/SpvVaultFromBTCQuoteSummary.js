import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { Alert, Badge, Button, Spinner } from 'react-bootstrap';
import { FEConstants } from '../../FEConstants';
import { ButtonWithWallet } from '../../wallets/ButtonWithWallet';
import { SwapExpiryProgressBar } from '../components/SwapExpiryProgressBar';
import { StepByStep } from '../../components/StepByStep';
import { ErrorAlert } from '../../components/ErrorAlert';
import { BaseButton } from '../../components/BaseButton';
import { useSpvVaultFromBtcQuote } from "./useSpvVaultFromBtcQuote";
/*
Steps:
1. Bitcoin payment -> Broadcasting bitcoin transaction -> Waiting bitcoin confirmations -> Bitcoin confirmed
2. Claim transaction -> Sending claim transaction -> Claim success
 */
export function SpvVaultFromBTCQuoteSummary(props) {
    const page = useSpvVaultFromBtcQuote(props.quote, props.setAmountLock, props.feeRate, props.balance);
    return (_jsxs(_Fragment, { children: [page.executionSteps ? _jsx(StepByStep, { quote: props.quote, steps: page.executionSteps }) : '', page.step1init ? (_jsxs(_Fragment, { children: [_jsx(SwapExpiryProgressBar, { expired: false, timeRemaining: page.step1init.expiry?.remaining, totalTime: page.step1init.expiry?.total, show: !!page.step1init.expiry, type: "bar", quoteAlias: "Quote" }), _jsx(ErrorAlert, { className: "mb-3", title: page.step1init.error?.title, error: page.step1init.error?.error }), _jsxs(ButtonWithWallet, { chainId: "BITCOIN", onClick: page.step1init.init?.onClick, className: "swap-panel__action", disabled: page.step1init.init?.disabled, size: "lg", children: [page.step1init.init?.loading ? _jsx(Spinner, { animation: "border", size: "sm", className: "mr-2" }) : '', "Pay with ", _jsx("img", { width: 20, height: 20, src: page.step1init.bitcoinWallet?.icon }), " ", page.step1init.bitcoinWallet?.name] })] })) : (''), page.step2broadcasting ? (_jsxs("div", { className: "d-flex flex-column align-items-center gap-2 tab-accent", children: [_jsx(Spinner, {}), _jsx("small", { className: "mt-2", children: "Sending bitcoin transaction..." })] })) : (''), page.step3awaitingConfirmations ? (_jsxs("div", { className: "d-flex flex-column align-items-center tab-accent", children: [_jsx("small", { className: "mb-2", children: "Transaction received, waiting for confirmations..." }), _jsx(Spinner, {}), _jsxs("label", { children: [page.step3awaitingConfirmations.txData.confirmations.actual, " / ", page.step3awaitingConfirmations.txData.confirmations.required] }), _jsx("label", { style: { marginTop: '-6px' }, children: "Confirmations" }), _jsx("a", { className: "mb-2 text-overflow-ellipsis text-nowrap overflow-hidden", style: { width: '100%' }, target: "_blank", href: FEConstants.btcBlockExplorer + page.step3awaitingConfirmations.txData.txId, children: _jsx("small", { children: page.step3awaitingConfirmations.txData.txId }) }), _jsxs(Badge, { className: 'text-black' + (page.step3awaitingConfirmations.txData.eta == null ? ' d-none' : ''), bg: "light", pill: true, children: ["ETA: ", page.step3awaitingConfirmations.txData.eta.text] }), page.step3awaitingConfirmations.error != null ? (_jsxs(_Fragment, { children: [_jsx(ErrorAlert, { className: "my-3 width-fill", title: page.step3awaitingConfirmations.error.title, error: page.step3awaitingConfirmations.error.error }), _jsx(Button, { onClick: page.step3awaitingConfirmations.error.retry, className: "width-fill", variant: "secondary", children: "Retry" })] })) : ('')] })) : (''), page.step4claim && page.step4claim.waitingForWatchtowerClaim ? (_jsxs("div", { className: "d-flex flex-column align-items-center tab-accent", children: [_jsx(Spinner, {}), _jsx("small", { className: "mt-2", children: "Transaction received & confirmed, waiting for claim by watchtowers..." })] })) : (''), page.step4claim && !page.step4claim.waitingForWatchtowerClaim ? (_jsxs(_Fragment, { children: [_jsx("div", { className: "d-flex flex-column align-items-center tab-accent mb-3", children: _jsx("label", { children: "Transaction received & confirmed, you can claim your funds manually now!" }) }), _jsx(ErrorAlert, { className: "mb-3", title: page.step4claim.error?.title, error: page.step4claim.error?.error }), _jsxs(ButtonWithWallet, { chainId: props.quote.chainIdentifier, className: "swap-panel__action", onClick: page.step4claim.claim.onClick, disabled: page.step4claim.claim.disabled, size: "lg", children: [page.step4claim.claim.loading ? _jsx(Spinner, { animation: "border", size: "sm", className: "mr-2" }) : '', "Finish swap (claim funds)"] })] })) : (''), page.step5?.state === "success" ? (_jsxs(Alert, { variant: "success", className: "mb-3", children: [_jsx("strong", { children: "Swap success" }), _jsx("label", { children: "Your swap was executed successfully!" })] })) : (''), page.step5?.state === "failed" ? (_jsxs(Alert, { variant: "danger", className: "mb-3", children: [_jsx("strong", { children: "Swap failed" }), _jsx("label", { children: "Swap transaction reverted, no funds were sent!" })] })) : (''), page.step5?.state === "expired" ? (_jsx(SwapExpiryProgressBar, { expired: true, timeRemaining: 0, totalTime: 1, show: true, type: "bar", expiryText: "Quote expired!", quoteAlias: "Quote" })) : (''), page.step5 ? (_jsx(BaseButton, { onClick: props.refreshQuote, className: "swap-panel__action", variant: "primary", size: "large", children: "New quote" })) : ('')] }));
}
